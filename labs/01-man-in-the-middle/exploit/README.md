# âš”ï¸ MITM Attack Tools - Exploit Scripts

Î‘Ï…Ï„Î¬ ÎµÎ¯Î½Î±Î¹ Ï„Î± **attack tools** Ï€Î¿Ï… Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ Î³Î¹Î± Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Man-in-the-Middle attacks.

## ğŸ“ Files

1. **`arp_spoof.py`** - ARP Spoofing Î³Î¹Î± Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¸Î¿ÏÎ¼Îµ Î±Î½Î¬Î¼ÎµÏƒÎ± ÏƒÏ„Î¿Î½ victim ÎºÎ±Î¹ Ï„Î¿ gateway
2. **`packet_sniffer.py`** - HTTP packet sniffer Î³Î¹Î± credential harvesting
3. **`mitm_proxy.py`** - Advanced MITM proxy Î¼Îµ Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± modification

---

## ğŸ› ï¸ Prerequisites

### Install Required Packages:

```bash
# For Python scripts
pip install scapy requests mitmproxy

# On Linux, you may also need:
sudo apt-get install python3-scapy
```

### Required Permissions:
âš ï¸ **All these tools require ROOT/ADMIN privileges** because they interact with network interfaces at a low level.

---

## ğŸ¯ Attack Scenarios

### Scenario 1: Basic Credential Sniffing (Beginner)

**Goal**: Capture HTTP credentials from the vulnerable client/server

**Steps**:

1. **Start the vulnerable server** (in another terminal):
   ```bash
   cd ../vulnerable/
   python server.py
   ```

2. **Start the packet sniffer**:
   ```bash
   sudo python3 packet_sniffer.py
   ```

3. **Run the vulnerable client** (in another terminal):
   ```bash
   cd ../vulnerable/
   python client.py
   ```
   Choose option 1 (Auto demo)

4. **Watch the sniffer terminal** - you'll see credentials captured! ğŸ¯

**Expected Output**:
```
ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨
ğŸ¯ CREDENTIALS CAPTURED!
ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨ğŸš¨
Username: admin
Password: supersecret123
Source:   127.0.0.1
...
```

---

### Scenario 2: ARP Spoofing (Intermediate)

**Goal**: Position yourself as MITM between two real machines on a network

**Prerequisites**:
- Two machines on the same network (or VMs)
- You need their IP addresses

**Steps**:

1. **Edit `arp_spoof.py` configuration**:
   ```python
   TARGET_IP = "192.168.1.100"    # Victim's IP
   GATEWAY_IP = "192.168.1.1"     # Router's IP
   INTERFACE = "eth0"             # Your network interface
   ```

2. **Run ARP spoofing**:
   ```bash
   sudo python3 arp_spoof.py
   ```

3. **In another terminal, run packet sniffer**:
   ```bash
   sudo python3 packet_sniffer.py
   ```

4. **Now all traffic from victim â†’ gateway flows through YOU!**
   - Any HTTP requests will be captured
   - Any credentials will be harvested

**How to verify it's working**:
- On victim machine, check ARP table:
  ```bash
  arp -a
  ```
  The gateway's MAC should now be YOUR MAC!

- On your machine, check if packets are being forwarded:
  ```bash
  cat /proc/sys/net/ipv4/ip_forward
  # Should show: 1
  ```

---

### Scenario 3: Advanced MITM Proxy (Advanced)

**Goal**: Intercept AND modify HTTP traffic in real-time

**Steps**:

1. **Start the MITM proxy**:
   ```bash
   mitmdump -s mitm_proxy.py -p 8888
   ```

2. **Configure victim's browser to use proxy**:
   - Proxy: `127.0.0.1` (or your IP)
   - Port: `8888`

   OR use iptables to redirect traffic:
   ```bash
   sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8888
   ```

3. **Victim browses to the vulnerable server**:
   ```
   http://127.0.0.1:8080
   ```

4. **Watch the proxy terminal** - you'll see EVERYTHING:
   - Requests
   - Responses
   - Credentials
   - AND you can modify them in real-time!

**Modification Examples** (uncomment in mitm_proxy.py):
- Change username from `alice` to `admin`
- Inject malicious JavaScript into responses
- Redirect to fake login pages

---

## ğŸ“Š Tool Comparison

| Tool | Difficulty | Stealth | Capabilities |
|------|-----------|---------|--------------|
| **packet_sniffer.py** | ğŸŸ¢ Easy | High | Passive sniffing, credential extraction |
| **arp_spoof.py** | ğŸŸ¡ Medium | Medium | MITM positioning, traffic redirection |
| **mitm_proxy.py** | ğŸ”´ Hard | Low | Full interception, modification, injection |

---

## ğŸ” Detection & Forensics

### How to detect if YOU are under MITM attack:

1. **Check ARP table for duplicates**:
   ```bash
   arp -a
   # Look for same MAC address with different IPs
   ```

2. **Monitor for ARP floods**:
   ```bash
   tcpdump -i eth0 arp
   # Too many ARP replies = suspicious
   ```

3. **Check SSL/TLS certificates**:
   - Browser warnings about invalid certificates
   - Certificate fingerprint doesn't match expected

4. **Latency spikes**:
   - MITM adds extra hops â†’ increased latency
   ```bash
   ping google.com
   # Sudden increase in RTT = red flag
   ```

---

## ğŸ›¡ï¸ How to Defend

### For Users:
1. âœ… **Use HTTPS Everywhere** - force encrypted connections
2. âœ… **VPN** - encrypts all traffic end-to-end
3. âœ… **Static ARP entries** - prevents ARP poisoning
   ```bash
   sudo arp -s 192.168.1.1 AA:BB:CC:DD:EE:FF
   ```

### For Network Admins:
1. âœ… **Port Security** - bind MAC addresses to switch ports
2. âœ… **Dynamic ARP Inspection (DAI)** - validates ARP packets
3. âœ… **DHCP Snooping** - prevents rogue DHCP servers
4. âœ… **Network Segmentation** - isolate critical systems

---

## âš ï¸ Ethical & Legal Warnings

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ THESE TOOLS ARE FOR EDUCATIONAL USE ONLY! ğŸš¨   â”‚
â”‚                                                     â”‚
â”‚  ILLEGAL to use on networks you don't own:         â”‚
â”‚  â€¢ ARP Spoofing = Computer Fraud                   â”‚
â”‚  â€¢ Packet Sniffing = Wiretapping                   â”‚
â”‚  â€¢ Credential Theft = Identity Theft               â”‚
â”‚                                                     â”‚
â”‚  Penalties:                                         â”‚
â”‚  â€¢ Heavy fines                                      â”‚
â”‚  â€¢ Prison time                                      â”‚
â”‚  â€¢ Criminal record                                  â”‚
â”‚                                                     â”‚
â”‚  âœ… ONLY use in:                                   â”‚
â”‚  â€¢ Your own lab environment                        â”‚
â”‚  â€¢ With explicit written permission                â”‚
â”‚  â€¢ For authorized penetration testing              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› Troubleshooting

### "Permission denied"
```bash
# Run with sudo
sudo python3 script.py
```

### "Network unreachable" / "No route to host"
```bash
# Check if IP forwarding is enabled
cat /proc/sys/net/ipv4/ip_forward  # Should be 1

# Enable it:
echo 1 | sudo tee /proc/sys/net/ipv4/ip_forward
```

### "Module not found: scapy"
```bash
pip install scapy
# OR
sudo apt-get install python3-scapy
```

### ARP spoofing not working
```bash
# Make sure you're on the same network segment
# Check with:
ip addr show

# Verify target is reachable:
ping 192.168.1.100
```

### Packet sniffer not capturing anything
```bash
# Check your interface name:
ip link show
# Common names: eth0, wlan0, enp0s3

# Update INTERFACE variable in scripts
```

---

## ğŸ“š Further Reading

- **ARP Spoofing**: https://en.wikipedia.org/wiki/ARP_spoofing
- **Scapy Documentation**: https://scapy.readthedocs.io/
- **mitmproxy Docs**: https://docs.mitmproxy.org/
- **Wireshark Tutorial**: https://www.wireshark.org/docs/

---

**Next**: Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿ `defense/` directory Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÎ¹Ï‚ Ï€ÏÏ‚ Î½Î± Î±Î¼Ï…Î½Î¸ÎµÎ¯Ï‚! ğŸ›¡ï¸
